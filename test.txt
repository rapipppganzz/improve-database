-- Auto Lag Server GUI
-- Compact Mobile Design with Drag Functionality

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- Lag Variables
local isLagging = false
local lagIntensity = 50
local lagMethod = "Particles"
local lagThreads = {}

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoLagServer"
screenGui.ResetOnSpawn = false
screenGui.Parent = player.PlayerGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 280, 0, 350)
mainFrame.Position = UDim2.new(0, 50, 0, 50)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 12)
mainCorner.Parent = mainFrame

-- Title Bar - DRAG AREA
local titleBar = Instance.new("TextButton")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
titleBar.BorderSizePixel = 0
titleBar.Text = ""
titleBar.AutoButtonColor = false
titleBar.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -50, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.BackgroundTransparency = 1
title.Text = "‚ö° Auto Lag Server"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 16
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = titleBar

-- Close Button
local closeBtn = Instance.new("TextButton")
closeBtn.Name = "CloseButton"
closeBtn.Size = UDim2.new(0, 30, 0, 30)
closeBtn.Position = UDim2.new(1, -35, 0.5, -15)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 59, 59)
closeBtn.Text = "‚úï"
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.TextSize = 14
closeBtn.Font = Enum.Font.GothamBold
closeBtn.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 6)
closeCorner.Parent = closeBtn

-- Content Frame
local contentFrame = Instance.new("Frame")
contentFrame.Name = "Content"
contentFrame.Size = UDim2.new(1, 0, 1, -40)
contentFrame.Position = UDim2.new(0, 0, 0, 40)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Status Display
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, -20, 0, 40)
statusLabel.Position = UDim2.new(0, 10, 0, 10)
statusLabel.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
statusLabel.Text = "üî¥ Lag: OFF"
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.TextSize = 14
statusLabel.Font = Enum.Font.GothamBold
statusLabel.Parent = contentFrame

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 8)
statusCorner.Parent = statusLabel

-- Lag Intensity Control
local intensityFrame = Instance.new("Frame")
intensityFrame.Size = UDim2.new(1, -20, 0, 70)
intensityFrame.Position = UDim2.new(0, 10, 0, 60)
intensityFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
intensityFrame.Parent = contentFrame

local intensityCorner = Instance.new("UICorner")
intensityCorner.CornerRadius = UDim.new(0, 8)
intensityCorner.Parent = intensityFrame

local intensityLabel = Instance.new("TextLabel")
intensityLabel.Size = UDim2.new(1, -10, 0, 25)
intensityLabel.Position = UDim2.new(0, 10, 0, 5)
intensityLabel.BackgroundTransparency = 1
intensityLabel.Text = "‚ö° Lag Intensity: 50%"
intensityLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
intensityLabel.TextSize = 14
intensityLabel.Font = Enum.Font.GothamBold
intensityLabel.TextXAlignment = Enum.TextXAlignment.Left
intensityLabel.Parent = intensityFrame

local intensitySlider = Instance.new("Frame")
intensitySlider.Name = "IntensitySlider"
intensitySlider.Size = UDim2.new(1, -20, 0, 6)
intensitySlider.Position = UDim2.new(0, 10, 0, 35)
intensitySlider.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
intensitySlider.Parent = intensityFrame

local sliderCorner = Instance.new("UICorner")
sliderCorner.CornerRadius = UDim.new(1, 0)
sliderCorner.Parent = intensitySlider

local intensityFill = Instance.new("Frame")
intensityFill.Name = "Fill"
intensityFill.Size = UDim2.new(0.5, 0, 1, 0)
intensityFill.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
intensityFill.BorderSizePixel = 0
intensityFill.Parent = intensitySlider

local fillCorner = Instance.new("UICorner")
fillCorner.CornerRadius = UDim.new(1, 0)
fillCorner.Parent = intensityFill

local intensityHandle = Instance.new("Frame")
intensityHandle.Name = "Handle"
intensityHandle.Size = UDim2.new(0, 16, 0, 16)
intensityHandle.Position = UDim2.new(0.5, -8, 0.5, -8)
intensityHandle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
intensityHandle.Parent = intensitySlider

local handleCorner = Instance.new("UICorner")
handleCorner.CornerRadius = UDim.new(1, 0)
handleCorner.Parent = intensityHandle

-- Lag Method Selection
local methodFrame = Instance.new("Frame")
methodFrame.Size = UDim2.new(1, -20, 0, 90)
methodFrame.Position = UDim2.new(0, 10, 0, 140)
methodFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
methodFrame.Parent = contentFrame

local methodCorner = Instance.new("UICorner")
methodCorner.CornerRadius = UDim.new(0, 8)
methodCorner.Parent = methodFrame

local methodLabel = Instance.new("TextLabel")
methodLabel.Size = UDim2.new(1, -10, 0, 25)
methodLabel.Position = UDim2.new(0, 10, 0, 5)
methodLabel.BackgroundTransparency = 1
methodLabel.Text = "üéØ Lag Method"
methodLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
methodLabel.TextSize = 14
methodLabel.Font = Enum.Font.GothamBold
methodLabel.TextXAlignment = Enum.TextXAlignment.Left
methodLabel.Parent = methodFrame

-- Method Buttons
local method1 = Instance.new("TextButton")
method1.Size = UDim2.new(1, -20, 0, 25)
method1.Position = UDim2.new(0, 10, 0, 35)
method1.BackgroundColor3 = Color3.fromRGB(52, 152, 219)
method1.Text = "üåÄ Particle Spam"
method1.TextColor3 = Color3.fromRGB(255, 255, 255)
method1.TextSize = 12
method1.Font = Enum.Font.GothamBold
method1.Parent = methodFrame

local method2 = Instance.new("TextButton")
method2.Size = UDim2.new(1, -20, 0, 25)
method2.Position = UDim2.new(0, 10, 0, 65)
method2.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
method2.Text = "üì° Network Flood"
method2.TextColor3 = Color3.fromRGB(255, 255, 255)
method2.TextSize = 12
method2.Font = Enum.Font.GothamBold
method2.Parent = methodFrame

local method1Corner = Instance.new("UICorner")
method1Corner.CornerRadius = UDim.new(0, 6)
method1Corner.Parent = method1

local method2Corner = Instance.new("UICorner")
method2Corner.CornerRadius = UDim.new(0, 6)
method2Corner.Parent = method2

-- Control Buttons
local startBtn = Instance.new("TextButton")
startBtn.Name = "StartButton"
startBtn.Size = UDim2.new(1, -20, 0, 45)
startBtn.Position = UDim2.new(0, 10, 0, 240)
startBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
startBtn.Text = "‚ñ∂Ô∏è START LAG"
startBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
startBtn.TextSize = 16
startBtn.Font = Enum.Font.GothamBold
startBtn.Parent = contentFrame

local startCorner = Instance.new("UICorner")
startCorner.CornerRadius = UDim.new(0, 8)
startCorner.Parent = startBtn

local stopBtn = Instance.new("TextButton")
stopBtn.Name = "StopButton"
stopBtn.Size = UDim2.new(1, -20, 0, 35)
stopBtn.Position = UDim2.new(0, 10, 0, 295)
stopBtn.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
stopBtn.Text = "‚èπÔ∏è STOP LAG"
stopBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
stopBtn.TextSize = 14
stopBtn.Font = Enum.Font.GothamBold
stopBtn.Parent = contentFrame

local stopCorner = Instance.new("UICorner")
stopCorner.CornerRadius = UDim.new(0, 8)
stopCorner.Parent = stopBtn

-- Floating Button
local floatingBtn = Instance.new("TextButton")
floatingBtn.Name = "FloatingButton"
floatingBtn.Size = UDim2.new(0, 60, 0, 60)
floatingBtn.Position = UDim2.new(0, 20, 0, 20)
floatingBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
floatingBtn.Text = "‚ö°"
floatingBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
floatingBtn.TextSize = 24
floatingBtn.Font = Enum.Font.GothamBold
floatingBtn.Visible = false
floatingBtn.ZIndex = 10
floatingBtn.Parent = screenGui

local floatingCorner = Instance.new("UICorner")
floatingCorner.CornerRadius = UDim.new(1, 0)
floatingCorner.Parent = floatingBtn

-- ========== DRAG FUNCTIONALITY ==========

local dragging = false
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Floating Button Drag
local floatingDragging = false
local floatingDragInput
local floatingDragStart
local floatingStartPos

local function updateFloating(input)
    local delta = input.Position - floatingDragStart
    floatingBtn.Position = UDim2.new(floatingStartPos.X.Scale, floatingStartPos.X.Offset + delta.X, floatingStartPos.Y.Scale, floatingStartPos.Y.Offset + delta.Y)
end

floatingBtn.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        floatingDragging = true
        floatingDragStart = input.Position
        floatingStartPos = floatingBtn.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                floatingDragging = false
            end
        end)
    end
end)

floatingBtn.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        floatingDragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == floatingDragInput and floatingDragging then
        updateFloating(input)
    end
end)

-- ========== LAG FUNCTIONALITY ==========

-- Intensity Slider
local draggingSlider = false

intensitySlider.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        draggingSlider = true
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        draggingSlider = false
    end
end)

RunService.RenderStepped:Connect(function()
    if draggingSlider then
        local mouse = player:GetMouse()
        local relativePos = math.clamp((mouse.X - intensitySlider.AbsolutePosition.X) / intensitySlider.AbsoluteSize.X, 0, 1)
        
        intensityFill.Size = UDim2.new(relativePos, 0, 1, 0)
        intensityHandle.Position = UDim2.new(relativePos, -8, 0.5, -8)
        
        lagIntensity = math.floor(relativePos * 100)
        intensityLabel.Text = "‚ö° Lag Intensity: " .. lagIntensity .. "%"
    end
end)

-- Method Selection
method1.MouseButton1Click:Connect(function()
    lagMethod = "Particles"
    method1.BackgroundColor3 = Color3.fromRGB(52, 152, 219)
    method2.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
    statusLabel.Text = "üéØ Method: Particle Spam"
end)

method2.MouseButton1Click:Connect(function()
    lagMethod = "Network"
    method2.BackgroundColor3 = Color3.fromRGB(52, 152, 219)
    method1.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
    statusLabel.Text = "üéØ Method: Network Flood"
end)

-- Lag Functions
local function createParticleLag()
    while isLagging do
        for i = 1, math.floor(lagIntensity / 10) + 1 do
            local part = Instance.new("Part")
            part.Name = "LagPart_" .. tick()
            part.Size = Vector3.new(1, 1, 1)
            part.Position = Vector3.new(
                math.random(-100, 100),
                math.random(10, 50),
                math.random(-100, 100)
            )
            part.Anchored = true
            part.CanCollide = false
            part.Parent = workspace
            
            -- Add some effects
            local fire = Instance.new("Fire")
            fire.Parent = part
            
            local sparkles = Instance.new("Sparkles")
            sparkles.Parent = part
            
            -- Auto clean after 2 seconds
            game:GetService("Debris"):AddItem(part, 2)
        end
        wait(0.1)
    end
end

local function createNetworkLag()
    while isLagging do
        -- Find RemoteEvents to spam
        for _, obj in pairs(game:GetDescendants()) do
            if obj:IsA("RemoteEvent") and isLagging then
                for i = 1, math.floor(lagIntensity / 20) + 1 do
                    pcall(function()
                        obj:FireServer("LAG_" .. tick())
                    end)
                end
            end
        end
        
        -- Spam some properties
        local character = player.Character
        if character then
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") and isLagging then
                    pcall(function()
                        part.Transparency = math.random()
                        part.Color = Color3.new(math.random(), math.random(), math.random())
                    end)
                end
            end
        end
        
        wait(0.05)
    end
end

local function startLag()
    if isLagging then return end
    
    isLagging = true
    statusLabel.Text = "üü¢ LAGGING - Intensity: " .. lagIntensity .. "%"
    statusLabel.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
    startBtn.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
    stopBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
    
    -- Clear previous threads
    for _, thread in pairs(lagThreads) do
        coroutine.close(thread)
    end
    lagThreads = {}
    
    -- Start lag based on method
    if lagMethod == "Particles" then
        local thread = coroutine.create(createParticleLag)
        coroutine.resume(thread)
        table.insert(lagThreads, thread)
    else
        local thread = coroutine.create(createNetworkLag)
        coroutine.resume(thread)
        table.insert(lagThreads, thread)
    end
    
    -- Additional stress threads
    for i = 1, math.floor(lagIntensity / 25) + 1 do
        local stressThread = coroutine.create(function()
            while isLagging do
                -- Heavy calculations
                local x = 0
                for j = 1, 10000 do
                    x = x + math.sqrt(j)
                end
                wait(0.1)
            end
        end)
        coroutine.resume(stressThread)
        table.insert(lagThreads, stressThread)
    end
    
    print("‚ö° Auto Lag Started - Method: " .. lagMethod .. " - Intensity: " .. lagIntensity .. "%")
end

local function stopLag()
    if not isLagging then return end
    
    isLagging = false
    statusLabel.Text = "üî¥ Lag: OFF"
    statusLabel.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
    startBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
    stopBtn.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
    
    -- Stop all lag threads
    for _, thread in pairs(lagThreads) do
        coroutine.close(thread)
    end
    lagThreads = {}
    
    -- Clean up lag parts
    for _, obj in pairs(workspace:GetDescendants()) do
        if string.find(obj.Name, "LagPart_") then
            obj:Destroy()
        end
    end
    
    print("‚ö° Auto Lag Stopped")
end

-- Control Buttons
startBtn.MouseButton1Click:Connect(function()
    startLag()
end)

stopBtn.MouseButton1Click:Connect(function()
    stopLag()
end)

-- Auto-stop when character dies
player.CharacterAdded:Connect(function()
    if isLagging then
        stopLag()
    end
end)

-- Window Management
closeBtn.MouseButton1Click:Connect(function()
    stopLag()
    mainFrame.Visible = false
    floatingBtn.Visible = true
end)

floatingBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = true
    floatingBtn.Visible = false
end)

-- Touch Feedback
local function addTouchFeedback(button)
    button.MouseButton1Down:Connect(function()
        button.BackgroundTransparency = 0.3
    end)
    
    button.MouseButton1Up:Connect(function()
        button.BackgroundTransparency = 0
    end)
    
    button.MouseLeave:Connect(function()
        button.BackgroundTransparency = 0
    end)
end

-- Add feedback to all buttons
for _, button in pairs(contentFrame:GetDescendants()) do
    if button:IsA("TextButton") then
        addTouchFeedback(button)
    end
end
addTouchFeedback(closeBtn)
addTouchFeedback(floatingBtn)

-- Initialize
method1.BackgroundColor3 = Color3.fromRGB(52, 152, 219) -- Default method
print("‚ö° Auto Lag Server GUI Loaded!")
print("üéØ Drag the title bar to move the window")
print("‚ö†Ô∏è Use responsibly - may cause performance issues")