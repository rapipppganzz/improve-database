-- Mobile-Optimized Mountain Checkpoint System
-- Designed for Android Phones with Floating Button

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Global Variables
local isRunning = false
local currentCheckpoint = 1
local loopEnabled = true
local teleportSpeed = 0.5
local checkpoints = {}

-- Remote Events for Global Notes
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local NotesEvent
if ReplicatedStorage:FindFirstChild("GlobalNotesEvent") then
    NotesEvent = ReplicatedStorage:WaitForChild("GlobalNotesEvent")
else
    NotesEvent = Instance.new("RemoteEvent")
    NotesEvent.Name = "GlobalNotesEvent"
    NotesEvent.Parent = ReplicatedStorage
end

-- Checkpoint System
local function scanCheckpoints()
    checkpoints = {}
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and (
            string.lower(obj.Name):find("checkpoint") or 
            string.lower(obj.Name):find("stage") or
            string.lower(obj.Name):find("platform") or
            string.lower(obj.Name):find("point")
        ) then
            table.insert(checkpoints, obj)
        end
    end
    
    table.sort(checkpoints, function(a, b)
        return a.Position.Y < b.Position.Y
    end)
    
    return #checkpoints
end

local function teleportToCheckpoint(checkpoint)
    if character and humanoidRootPart and checkpoint then
        humanoidRootPart.CFrame = checkpoint.CFrame + Vector3.new(0, 5, 0)
    end
end

-- Backdoor Scanner Functions
local function scanForBackdoors()
    local results = {
        remoteEvents = {},
        remoteFunctions = {},
        suspiciousScripts = {},
        vulnerabilityLevel = "UNKNOWN",
        totalFound = 0
    }
    
    for _, obj in pairs(game:GetDescendants()) do
        if obj:IsA("RemoteEvent") then
            table.insert(results.remoteEvents, {
                Name = obj.Name,
                Path = obj:GetFullName(),
                Parent = obj.Parent.Name
            })
            results.totalFound = results.totalFound + 1
        elseif obj:IsA("RemoteFunction") then
            table.insert(results.remoteFunctions, {
                Name = obj.Name,
                Path = obj:GetFullName(),
                Parent = obj.Parent.Name
            })
            results.totalFound = results.totalFound + 1
        elseif obj:IsA("Script") or obj:IsA("LocalScript") then
            local suspiciousNames = {"admin", "backdoor", "execute", "command", "control", "hack", "script", "remote"}
            local lowerName = string.lower(obj.Name)
            for _, name in pairs(suspiciousNames) do
                if string.find(lowerName, name) then
                    table.insert(results.suspiciousScripts, {
                        Name = obj.Name,
                        Path = obj:GetFullName(),
                        Type = obj.ClassName
                    })
                    results.totalFound = results.totalFound + 1
                    break
                end
            end
        end
    end
    
    if results.totalFound > 10 then
        results.vulnerabilityLevel = "üî¥ HIGH VULNERABILITY"
    elseif results.totalFound > 5 then
        results.vulnerabilityLevel = "üü° MEDIUM VULNERABILITY"
    elseif results.totalFound > 0 then
        results.vulnerabilityLevel = "üü¢ LOW VULNERABILITY"
    else
        results.vulnerabilityLevel = "‚ö™ NO VULNERABILITY DETECTED"
    end
    
    return results
end

-- Create Main GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MobileMountainCheckpoint"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = player.PlayerGui

-- Main Frame (Mobile Optimized)
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0.85, 0, 0.7, 0) -- 85% width, 70% height
mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 15)
mainCorner.Parent = mainFrame

-- Shadow Effect
local shadow = Instance.new("ImageLabel")
shadow.Name = "Shadow"
shadow.Size = UDim2.new(1, 20, 1, 20)
shadow.Position = UDim2.new(0, -10, 0, -10)
shadow.BackgroundTransparency = 1
shadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
shadow.ImageTransparency = 0.8
shadow.ZIndex = 0
shadow.Parent = mainFrame

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 60)
titleBar.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 15)
titleCorner.Parent = titleBar

local titleCover = Instance.new("Frame")
titleCover.Size = UDim2.new(1, 0, 0, 15)
titleCover.Position = UDim2.new(0, 0, 1, -15)
titleCover.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
titleCover.BorderSizePixel = 0
titleCover.Parent = titleBar

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -70, 1, 0)
title.Position = UDim2.new(0, 15, 0, 0)
title.BackgroundTransparency = 1
title.Text = "‚õ∞Ô∏è Mountain Tools"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 20
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = titleBar

-- Close Button (Mobile Friendly - Larger)
local closeBtn = Instance.new("TextButton")
closeBtn.Name = "CloseButton"
closeBtn.Size = UDim2.new(0, 50, 0, 50)
closeBtn.Position = UDim2.new(1, -55, 0, 5)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 59, 59)
closeBtn.Text = "‚úï"
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.TextSize = 24
closeBtn.Font = Enum.Font.GothamBold
closeBtn.Parent = titleBar

local closeBtnCorner = Instance.new("UICorner")
closeBtnCorner.CornerRadius = UDim.new(0, 10)
closeBtnCorner.Parent = closeBtn

-- Content Frame with Scrolling
local contentScroll = Instance.new("ScrollingFrame")
contentScroll.Name = "ContentScroll"
contentScroll.Size = UDim2.new(1, 0, 1, -70)
contentScroll.Position = UDim2.new(0, 0, 0, 70)
contentScroll.BackgroundTransparency = 1
contentScroll.ScrollBarThickness = 8
contentScroll.CanvasSize = UDim2.new(0, 0, 2, 0) -- Allow scrolling
contentScroll.Parent = mainFrame

-- Content Container
local contentFrame = Instance.new("Frame")
contentFrame.Name = "Content"
contentFrame.Size = UDim2.new(1, 0, 2, 0) -- Double height for scrolling
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = contentScroll

-- Make content frame match scroll canvas
contentScroll:GetPropertyChangedSignal("AbsoluteSize"):Connect(function()
    contentScroll.CanvasSize = UDim2.new(0, 0, 0, contentFrame.AbsoluteSize.Y)
end)

-- Checkpoint Section Title
local checkpointTitle = Instance.new("TextLabel")
checkpointTitle.Size = UDim2.new(1, -20, 0, 40)
checkpointTitle.Position = UDim2.new(0, 10, 0, 10)
checkpointTitle.BackgroundTransparency = 1
checkpointTitle.Text = "üéØ CHECKPOINT SYSTEM"
checkpointTitle.TextColor3 = Color3.fromRGB(138, 43, 226)
checkpointTitle.TextSize = 18
checkpointTitle.Font = Enum.Font.GothamBold
checkpointTitle.Parent = contentFrame

-- Status Label
local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, -20, 0, 40)
statusLabel.Position = UDim2.new(0, 10, 0, 60)
statusLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
statusLabel.Text = "üî¥ Status: Stopped"
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.TextSize = 16
statusLabel.Font = Enum.Font.Gotham
statusLabel.Parent = contentFrame

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 10)
statusCorner.Parent = statusLabel

-- Checkpoint Info
local checkpointInfo = Instance.new("TextLabel")
checkpointInfo.Name = "CheckpointInfo"
checkpointInfo.Size = UDim2.new(1, -20, 0, 40)
checkpointInfo.Position = UDim2.new(0, 10, 0, 110)
checkpointInfo.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
checkpointInfo.Text = "üìç Checkpoint: 0 / 0"
checkpointInfo.TextColor3 = Color3.fromRGB(255, 255, 255)
checkpointInfo.TextSize = 16
checkpointInfo.Font = Enum.Font.Gotham
checkpointInfo.Parent = contentFrame

local checkpointCorner = Instance.new("UICorner")
checkpointCorner.CornerRadius = UDim.new(0, 10)
checkpointCorner.Parent = checkpointInfo

-- Scan Button (Larger for mobile)
local scanBtn = Instance.new("TextButton")
scanBtn.Name = "ScanButton"
scanBtn.Size = UDim2.new(1, -20, 0, 50)
scanBtn.Position = UDim2.new(0, 10, 0, 160)
scanBtn.BackgroundColor3 = Color3.fromRGB(52, 152, 219)
scanBtn.Text = "üîç Scan Checkpoints"
scanBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
scanBtn.TextSize = 18
scanBtn.Font = Enum.Font.GothamBold
scanBtn.Parent = contentFrame

local scanCorner = Instance.new("UICorner")
scanCorner.CornerRadius = UDim.new(0, 10)
scanCorner.Parent = scanBtn

-- Start/Stop Button (Larger for mobile)
local toggleBtn = Instance.new("TextButton")
toggleBtn.Name = "ToggleButton"
toggleBtn.Size = UDim2.new(1, -20, 0, 60)
toggleBtn.Position = UDim2.new(0, 10, 0, 220)
toggleBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
toggleBtn.Text = "‚ñ∂Ô∏è Start Auto TP"
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.TextSize = 20
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.Parent = contentFrame

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 10)
toggleCorner.Parent = toggleBtn

-- Loop Toggle
local loopFrame = Instance.new("Frame")
loopFrame.Name = "LoopFrame"
loopFrame.Size = UDim2.new(1, -20, 0, 50)
loopFrame.Position = UDim2.new(0, 10, 0, 290)
loopFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
loopFrame.Parent = contentFrame

local loopCorner = Instance.new("UICorner")
loopCorner.CornerRadius = UDim.new(0, 10)
loopCorner.Parent = loopFrame

local loopLabel = Instance.new("TextLabel")
loopLabel.Size = UDim2.new(0.7, 0, 1, 0)
loopLabel.BackgroundTransparency = 1
loopLabel.Text = "üîÑ Loop Mode"
loopLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
loopLabel.TextSize = 16
loopLabel.Font = Enum.Font.GothamBold
loopLabel.TextXAlignment = Enum.TextXAlignment.Left
loopLabel.Position = UDim2.new(0, 15, 0, 0)
loopLabel.Parent = loopFrame

local loopToggle = Instance.new("TextButton")
loopToggle.Name = "LoopToggle"
loopToggle.Size = UDim2.new(0, 70, 0, 35)
loopToggle.Position = UDim2.new(1, -80, 0.5, -17.5)
loopToggle.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
loopToggle.Text = "ON"
loopToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
loopToggle.TextSize = 16
loopToggle.Font = Enum.Font.GothamBold
loopToggle.Parent = loopFrame

local loopToggleCorner = Instance.new("UICorner")
loopToggleCorner.CornerRadius = UDim.new(0, 8)
loopToggleCorner.Parent = loopToggle

-- Speed Slider
local speedFrame = Instance.new("Frame")
speedFrame.Name = "SpeedFrame"
speedFrame.Size = UDim2.new(1, -20, 0, 80)
speedFrame.Position = UDim2.new(0, 10, 0, 350)
speedFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
speedFrame.Parent = contentFrame

local speedCorner = Instance.new("UICorner")
speedCorner.CornerRadius = UDim.new(0, 10)
speedCorner.Parent = speedFrame

local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(1, -20, 0, 30)
speedLabel.Position = UDim2.new(0, 10, 0, 10)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "‚ö° TP Speed: 0.5s"
speedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
speedLabel.TextSize = 16
speedLabel.Font = Enum.Font.GothamBold
speedLabel.TextXAlignment = Enum.TextXAlignment.Left
speedLabel.Parent = speedFrame

local speedSlider = Instance.new("Frame")
speedSlider.Name = "SpeedSlider"
speedSlider.Size = UDim2.new(1, -20, 0, 8)
speedSlider.Position = UDim2.new(0, 10, 0, 50)
speedSlider.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
speedSlider.Parent = speedFrame

local sliderCorner = Instance.new("UICorner")
sliderCorner.CornerRadius = UDim.new(1, 0)
sliderCorner.Parent = speedSlider

local speedFill = Instance.new("Frame")
speedFill.Name = "Fill"
speedFill.Size = UDim2.new(0.5, 0, 1, 0)
speedFill.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
speedFill.BorderSizePixel = 0
speedFill.Parent = speedSlider

local fillCorner = Instance.new("UICorner")
fillCorner.CornerRadius = UDim.new(1, 0)
fillCorner.Parent = speedFill

local speedHandle = Instance.new("Frame")
speedHandle.Name = "Handle"
speedHandle.Size = UDim2.new(0, 20, 0, 20) -- Larger handle for mobile
speedHandle.Position = UDim2.new(0.5, -10, 0.5, -10)
speedHandle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
speedHandle.Parent = speedSlider

local handleCorner = Instance.new("UICorner")
handleCorner.CornerRadius = UDim.new(1, 0)
handleCorner.Parent = speedHandle

-- Reset Button
local resetBtn = Instance.new("TextButton")
resetBtn.Name = "ResetButton"
resetBtn.Size = UDim2.new(1, -20, 0, 50)
resetBtn.Position = UDim2.new(0, 10, 0, 440)
resetBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
resetBtn.Text = "üîÑ Reset to Checkpoint 1"
resetBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
resetBtn.TextSize = 16
resetBtn.Font = Enum.Font.GothamBold
resetBtn.Parent = contentFrame

local resetCorner = Instance.new("UICorner")
resetCorner.CornerRadius = UDim.new(0, 10)
resetCorner.Parent = resetBtn

-- Backdoor Scanner Section Title
local backdoorTitle = Instance.new("TextLabel")
backdoorTitle.Size = UDim2.new(1, -20, 0, 40)
backdoorTitle.Position = UDim2.new(0, 10, 0, 500)
backdoorTitle.BackgroundTransparency = 1
backdoorTitle.Text = "üîì SECURITY SCANNER"
backdoorTitle.TextColor3 = Color3.fromRGB(231, 76, 60)
backdoorTitle.TextSize = 18
backdoorTitle.Font = Enum.Font.GothamBold
backdoorTitle.Parent = contentFrame

-- Backdoor Scan Button
local backdoorScanBtn = Instance.new("TextButton")
backdoorScanBtn.Name = "BackdoorScanButton"
backdoorScanBtn.Size = UDim2.new(1, -20, 0, 50)
backdoorScanBtn.Position = UDim2.new(0, 10, 0, 550)
backdoorScanBtn.BackgroundColor3 = Color3.fromRGB(230, 126, 34)
backdoorScanBtn.Text = "üîç Scan Backdoors"
backdoorScanBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
backdoorScanBtn.TextSize = 16
backdoorScanBtn.Font = Enum.Font.GothamBold
backdoorScanBtn.Parent = contentFrame

local backdoorScanCorner = Instance.new("UICorner")
backdoorScanCorner.CornerRadius = UDim.new(0, 10)
backdoorScanCorner.Parent = backdoorScanBtn

-- Backdoor Scan Result
local backdoorResult = Instance.new("TextLabel")
backdoorResult.Name = "BackdoorResult"
backdoorResult.Size = UDim2.new(1, -20, 0, 120)
backdoorResult.Position = UDim2.new(0, 10, 0, 610)
backdoorResult.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
backdoorResult.TextColor3 = Color3.fromRGB(255, 255, 255)
backdoorResult.TextSize = 14
backdoorResult.Font = Enum.Font.Gotham
backdoorResult.TextXAlignment = Enum.TextXAlignment.Left
backdoorResult.TextYAlignment = Enum.TextYAlignment.Top
backdoorResult.TextWrapped = true
backdoorResult.Text = "Click 'Scan Backdoors' to check server vulnerability..."
backdoorResult.Parent = contentFrame

local resultCorner = Instance.new("UICorner")
resultCorner.CornerRadius = UDim.new(0, 10)
resultCorner.Parent = backdoorResult

-- Command Execution Section
local commandFrame = Instance.new("Frame")
commandFrame.Name = "CommandFrame"
commandFrame.Size = UDim2.new(1, -20, 0, 60)
commandFrame.Position = UDim2.new(0, 10, 0, 740)
commandFrame.BackgroundTransparency = 1
commandFrame.Parent = contentFrame

local commandBox = Instance.new("TextBox")
commandBox.Name = "CommandInput"
commandBox.Size = UDim2.new(0.65, 0, 1, 0)
commandBox.Position = UDim2.new(0, 0, 0, 0)
commandBox.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
commandBox.TextColor3 = Color3.fromRGB(255, 255, 255)
commandBox.PlaceholderText = "Server command..."
commandBox.Text = ""
commandBox.TextSize = 14
commandBox.Font = Enum.Font.Gotham
commandBox.Parent = commandFrame

local commandCorner = Instance.new("UICorner")
commandCorner.CornerRadius = UDim.new(0, 8)
commandCorner.Parent = commandBox

local executeBtn = Instance.new("TextButton")
executeBtn.Name = "ExecuteButton"
executeBtn.Size = UDim2.new(0.35, -5, 1, 0)
executeBtn.Position = UDim2.new(0.65, 5, 0, 0)
executeBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
executeBtn.Text = "‚ö° Execute"
executeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
executeBtn.TextSize = 16
executeBtn.Font = Enum.Font.GothamBold
executeBtn.Parent = commandFrame

local executeCorner = Instance.new("UICorner")
executeCorner.CornerRadius = UDim.new(0, 8)
executeCorner.Parent = executeBtn

-- Floating Button (Will appear when GUI is closed)
local floatingBtn = Instance.new("TextButton")
floatingBtn.Name = "FloatingButton"
floatingBtn.Size = UDim2.new(0, 70, 0, 70)
floatingBtn.Position = UDim2.new(0, 20, 0.5, -35)
floatingBtn.AnchorPoint = Vector2.new(0, 0.5)
floatingBtn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
floatingBtn.Text = "‚õ∞Ô∏è"
floatingBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
floatingBtn.TextSize = 30
floatingBtn.Font = Enum.Font.GothamBold
floatingBtn.Visible = false -- Hidden initially
floatingBtn.ZIndex = 10
floatingBtn.Parent = screenGui

local floatingCorner = Instance.new("UICorner")
floatingCorner.CornerRadius = UDim.new(1, 0)
floatingCorner.Parent = floatingBtn

-- Shadow for floating button
local floatingShadow = Instance.new("ImageLabel")
floatingShadow.Name = "FloatingShadow"
floatingShadow.Size = UDim2.new(1, 10, 1, 10)
floatingShadow.Position = UDim2.new(0, -5, 0, -5)
floatingShadow.BackgroundTransparency = 1
floatingShadow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
floatingShadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
floatingShadow.ImageTransparency = 0.7
floatingShadow.ZIndex = 9
floatingShadow.Parent = floatingBtn

-- Mobile Drag functionality
local dragging, dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Floating button drag functionality
local floatingDragging, floatingDragInput, floatingDragStart, floatingStartPos

floatingBtn.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        floatingDragging = true
        floatingDragStart = input.Position
        floatingStartPos = floatingBtn.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                floatingDragging = false
            end
        end)
    end
end)

floatingBtn.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
        floatingDragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == floatingDragInput and floatingDragging then
        local delta = input.Position - floatingDragStart
        floatingBtn.Position = UDim2.new(floatingStartPos.X.Scale, floatingStartPos.X.Offset + delta.X, floatingStartPos.Y.Scale, floatingStartPos.Y.Offset + delta.Y)
    end
end)

-- Speed slider functionality (mobile optimized)
local draggingSlider = false

speedSlider.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingSlider = true
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingSlider = false
    end
end)

RunService.RenderStepped:Connect(function()
    if draggingSlider then
        local mouse = player:GetMouse()
        local relativePos = math.clamp((mouse.X - speedSlider.AbsolutePosition.X) / speedSlider.AbsoluteSize.X, 0, 1)
        
        speedFill.Size = UDim2.new(relativePos, 0, 1, 0)
        speedHandle.Position = UDim2.new(relativePos, -10, 0.5, -10)
        
        teleportSpeed = 0.1 + (relativePos * 1.9)
        speedLabel.Text = string.format("‚ö° TP Speed: %.1fs", teleportSpeed)
    end
end)

-- Backdoor Scanner Functions
backdoorScanBtn.MouseButton1Click:Connect(function()
    local results = scanForBackdoors()
    
    local resultText = "üîì SCAN RESULTS:\n\n"
    resultText = resultText .. "üìä " .. results.vulnerabilityLevel .. "\n"
    resultText = resultText .. "üìà Total Objects: " .. results.totalFound .. "\n\n"
    
    if #results.remoteEvents > 0 then
        resultText = resultText .. "üì° RemoteEvents (" .. #results.remoteEvents .. "):\n"
        for i, remote in ipairs(results.remoteEvents) do
            if i <= 3 then -- Limit display for mobile
                resultText = resultText .. "  " .. i .. ". " .. remote.Name .. "\n"
            end
        end
        if #results.remoteEvents > 3 then
            resultText = resultText .. "  ... and " .. (#results.remoteEvents - 3) .. " more\n"
        end
        resultText = resultText .. "\n"
    end
    
    if #results.suspiciousScripts > 0 then
        resultText = resultText .. "‚ö†Ô∏è Suspicious (" .. #results.suspiciousScripts .. "):\n"
        for i, script in ipairs(results.suspiciousScripts) do
            if i <= 2 then -- Limit display for mobile
                resultText = resultText .. "  " .. i .. ". " .. script.Name .. "\n"
            end
        end
        if #results.suspiciousScripts > 2 then
            resultText = resultText .. "  ... and " .. (#results.suspiciousScripts - 2) .. " more"
        end
    end
    
    if results.totalFound == 0 then
        resultText = resultText .. "‚úÖ No vulnerabilities detected."
    end
    
    backdoorResult.Text = resultText
    
    -- Visual feedback
    backdoorScanBtn.BackgroundColor3 = Color3.fromRGB(39, 174, 96)
    wait(0.3)
    backdoorScanBtn.BackgroundColor3 = Color3.fromRGB(230, 126, 34)
end)

-- Command Execution Function
executeBtn.MouseButton1Click:Connect(function()
    local command = commandBox.Text
    if command == "" then return end
    
    local results = scanForBackdoors()
    local executed = false
    
    -- Try RemoteEvents first
    for _, remote in ipairs(results.remoteEvents) do
        local remoteObj = game:GetService("ReplicatedStorage"):FindFirstChild(remote.Name)
        if remoteObj and remoteObj:IsA("RemoteEvent") then
            pcall(function()
                remoteObj:FireServer(command)
                backdoorResult.Text = "‚úÖ Command sent via: " .. remote.Name .. "\nCommand: " .. command
                executed = true
            end)
            break
        end
    end
    
    if not executed then
        for _, remote in ipairs(results.remoteFunctions) do
            local remoteObj = game:GetService("ReplicatedStorage"):FindFirstChild(remote.Name)
            if remoteObj and remoteObj:IsA("RemoteFunction") then
                pcall(function()
                    remoteObj:InvokeServer(command)
                    backdoorResult.Text = "‚úÖ Command invoked via: " .. remote.Name .. "\nCommand: " .. command
                    executed = true
                end)
                break
            end
        end
    end
    
    if not executed then
        backdoorResult.Text = "‚ùå No backdoor found.\nTry scanning first."
    end
    
    commandBox.Text = ""
end)

-- Checkpoint Auto TP Function
local function startAutoTP()
    isRunning = true
    statusLabel.Text = "üü¢ Status: Running"
    toggleBtn.Text = "‚è∏Ô∏è Stop Auto TP"
    toggleBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
    
    spawn(function()
        while isRunning and #checkpoints > 0 do
            if currentCheckpoint > #checkpoints then
                if loopEnabled then
                    currentCheckpoint = 1
                else
                    isRunning = false
                    statusLabel.Text = "‚úÖ Status: Completed"
                    toggleBtn.Text = "‚ñ∂Ô∏è Start Auto TP"
                    toggleBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
                    break
                end
            end
            
            checkpointInfo.Text = string.format("üìç Checkpoint: %d / %d", currentCheckpoint, #checkpoints)
            teleportToCheckpoint(checkpoints[currentCheckpoint])
            
            currentCheckpoint = currentCheckpoint + 1
            wait(teleportSpeed)
        end
    end)
end

-- Button functions
scanBtn.MouseButton1Click:Connect(function()
    local count = scanCheckpoints()
    checkpointInfo.Text = string.format("üìç Found: %d checkpoints", count)
    currentCheckpoint = 1
    
    scanBtn.BackgroundColor3 = Color3.fromRGB(39, 174, 96)
    wait(0.2)
    scanBtn.BackgroundColor3 = Color3.fromRGB(52, 152, 219)
end)

toggleBtn.MouseButton1Click:Connect(function()
    if #checkpoints == 0 then
        checkpointInfo.Text = "‚ö†Ô∏è Scan checkpoints first!"
        return
    end
    
    if isRunning then
        isRunning = false
        statusLabel.Text = "üî¥ Status: Stopped"
        toggleBtn.Text = "‚ñ∂Ô∏è Start Auto TP"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
    else
        startAutoTP()
    end
end)

loopToggle.MouseButton1Click:Connect(function()
    loopEnabled = not loopEnabled
    if loopEnabled then
        loopToggle.Text = "ON"
        loopToggle.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
    else
        loopToggle.Text = "OFF"
        loopToggle.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
    end
end)

resetBtn.MouseButton1Click:Connect(function()
    currentCheckpoint = 1
    if #checkpoints > 0 then
        teleportToCheckpoint(checkpoints[1])
        checkpointInfo.Text = "üìç Checkpoint: 1 / " .. #checkpoints
    end
end)

-- Close Button Functionality (Toggle GUI)
closeBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
    floatingBtn.Visible = true
end)

-- Floating Button Functionality (Show GUI)
floatingBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = true
    floatingBtn.Visible = false
end)

-- Auto-scan on load
wait(1)
scanCheckpoints()
checkpointInfo.Text = string.format("üìç Found: %d checkpoints", #checkpoints)

-- Enter key to execute commands
commandBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        executeBtn.MouseButton1Click:Wait()
    end
end)

-- Mobile touch feedback
local function addTouchFeedback(button)
    button.MouseButton1Down:Connect(function()
        button.BackgroundTransparency = 0.3
    end)
    
    button.MouseButton1Up:Connect(function()
        button.BackgroundTransparency = 0
    end)
    
    button.MouseLeave:Connect(function()
        button.BackgroundTransparency = 0
    end)
end

-- Add touch feedback to all buttons
for _, button in pairs(contentFrame:GetDescendants()) do
    if button:IsA("TextButton") then
        addTouchFeedback(button)
    end
end
addTouchFeedback(closeBtn)
addTouchFeedback(floatingBtn)

print("üì± Mobile Mountain Checkpoint System Loaded!")
print("üí° Tap the floating button to open/close the menu")